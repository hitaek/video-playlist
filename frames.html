<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic Frames with AJAX</title>
<style>
    body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
        overflow: hidden;
    }
    .frame {
        box-sizing: border-box;
        border: 1px solid #ccc;
        overflow: hidden;
        float: left;
    }
    .frame iframe {
        width: 100%;
        height: 100%;
        border: none;
    }
    #addFrameBtn {
        position: fixed;
        top: 20px;
        right: 20px;
        font-size: 24px;
        cursor: pointer;
    }
    #urlListInput {
        width: calc(100% - 40px);
        padding: 5px;
        font-size: 16px;
        border: 1px solid #ccc;
        margin: 20px;
    }
</style>
</head>
<body>
<input type="text" id="urlListInput" placeholder="Enter up to 9 URLs separated by commas">
<div id="container">
    <div class="frame" id="frame1">
        <input type="text" class="urlInput" placeholder="Enter URL">
        <br>
        <div class="frameContent"></div>
        <button class="closeBtn" onclick="closeFrame(this.parentNode)">Close</button>
    </div>
    <div class="frame" id="frame2">
        <input type="text" class="urlInput" placeholder="Enter URL">
        <br>
        <div class="frameContent"></div>
        <button class="closeBtn" onclick="closeFrame(this.parentNode)">Close</button>
    </div>
    <div class="frame" id="frame3">
        <input type="text" class="urlInput" placeholder="Enter URL">
        <br>
        <div class="frameContent"></div>
        <button class="closeBtn" onclick="closeFrame(this.parentNode)">Close</button>
    </div>
</div>
<div id="addFrameBtn" onclick="addFrame()">+</div>

<script>
    async function loadURL(input) {
        const frameContent = input.parentNode.querySelector('.frameContent');
        let url = input.value;
        if (!url.startsWith('http://') && !url.startsWith('https://')) {
            url = 'https://' + url;
        }
        try {
            const response = await fetch('https://cors-anywhere.herokuapp.com/' + url);
            const content = await response.text();
            frameContent.innerHTML = content;
        } catch (error) {
            console.error('Error loading content:', error);
        }
    }

    document.querySelectorAll('.urlInput').forEach(input => {
        input.addEventListener('blur', function() {
            loadURL(this);
        });

        input.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                loadURL(this);
            }
        });
    });

    function addFrame() {
        const container = document.getElementById('container');
        const frameCount = container.querySelectorAll('.frame').length;
        if (frameCount < 9) { // Maximum 9 frames
            const newFrame = document.createElement('div');
            newFrame.classList.add('frame');
            newFrame.innerHTML = `
                <input type="text" class="urlInput" placeholder="Enter URL">
                <br>
                <div class="frameContent"></div>
                <button class="closeBtn" onclick="closeFrame(this.parentNode)">Close</button>
            `;
            container.appendChild(newFrame);
            updateFrameWidths();
        } else {
            alert('Maximum number of frames reached!');
        }
    }

    function closeFrame(frame) {
        frame.parentNode.removeChild(frame);
        updateFrameWidths();
    }

    function updateFrameWidths() {
        const frames = document.querySelectorAll('.frame');
        const frameCount = frames.length;
        const containerWidth = document.getElementById('container').offsetWidth;
        const frameWidth = containerWidth / Math.ceil(Math.sqrt(frameCount));
        frames.forEach(frame => {
            frame.style.width = frameWidth + 'px';
        });
    }

    window.addEventListener('resize', updateFrameWidths);
    updateFrameWidths();

    document.getElementById('urlListInput').addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            loadURLs();
        }
    });

    function loadURLs() {
        const urlListInput = document.getElementById('urlListInput');
        const urls = urlListInput.value.split(',').slice(0, 9); // Take up to 9 URLs
        const frames = document.querySelectorAll('.frame');
        urls.forEach((url, index) => {
            if (index < frames.length) {
                const frameContent = frames[index].querySelector('.frameContent');
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                loadURLIntoFrame(url, frameContent);
            } else {
                addFrame();
                const newFrame = document.querySelectorAll('.frame')[index];
                const frameContent = newFrame.querySelector('.frameContent');
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                loadURLIntoFrame(url, frameContent);
            }
        });
        // Clear remaining frames if fewer than 9 URLs were provided
        for (let i = urls.length; i < frames.length; i++) {
            frames[i].querySelector('.frameContent').innerHTML = '';
        }
        updateFrameWidths(); // Adjust frame widths after loading URLs
    }

    async function loadURLIntoFrame(url, frameContent) {
        try {
            const response = await fetch('https://cors-anywhere.herokuapp.com/' + url);
            const content = await response.text();
            frameContent.innerHTML = content;
        } catch (error) {
            console.error('Error loading content:', error);
        }
    }
</script>
</body>
</html>